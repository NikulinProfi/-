<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <title>Игра в угадывание чисел</title>

    <style>
      html {
        font-family: sans-serif;
      }

      body {
        width: 50%; 
        max-width: 800px;
        min-width: 320px;
        margin: 0 auto;
      }

      .lastResult {
        color: white;
        padding: 3px;
      }
    </style>
  </head>

  <body>
    <h1>Игра в угадывание чисел</h1>

    <p>
      Мы выбрали случайное число от 1 до 100. Посмотрите, сможете ли вы угадать
      его за 10 ходов или меньше. Мы сообщим вам, была ли ваша догадка слишком
      высокой или слишком низкой.
    </p>

    <!-- Следующие две переменных хранят ссылки на форму ввода текста и кнопку отправки, а позже используются для управления подачи догадки. -->
    <div class="form">
      <label for="guessField">Введите предположение: </label>
      <input type="text" id="guessField" class="guessField" />
      <input type="submit" value="Отправить" class="guessSubmit" />
    </div>

    <!-- Каждая из первых трех констант предназначена для хранения ссылки на абзацы
    результатов в нашем HTML и используется для вставки значений в абзацы позже
    в коде: -->
    <div class="resultParas">
      <p class="guesses"></p>
      <p class="lastResult"></p>
      <p class="lowOrHi"></p>
    </div>

    <script>
      //Первой переменной - randomNumber - присваивается случайное число от 1 до 100, вычисленное с использованием математического алгоритма.
      let randomNumber = Math.floor(Math.random() * 100) + 1

      //Следующие три переменные сделаны для хранения ссылок на абзацы результатов в нашем HTML и используются для вставки значений в абзацы, приведённые далее в коде:
      const guesses = document.querySelector('.guesses')
      const lastResult = document.querySelector('.lastResult')
      const lowOrHi = document.querySelector('.lowOrHi')

      //Наши последние две переменные сохраняют количество догадок 1 (используется для отслеживания того, сколько догадок у игрока было), и ссылку на кнопку сброса, которая ещё не существует (но позже).
      const guessSubmit = document.querySelector('.guessSubmit')
      const guessField = document.querySelector('.guessField')

      let guessCount = 1
      let resetButton

      //Функции представляют собой многократно используемые блоки кода. Написав один раз, вы можете запускать их снова и снова, сохраняя нужный постоянно повторяющийся код. Это действительно полезно. Существует несколько способов определить функцию, но пока мы сосредоточимся на одном простом варианте. Здесь мы определили функцию, используя ключевое слово function, за ним идёт имя с двумя скобками после него. После этого мы добавляем две фигурные скобки ({ }). Внутри фигурных скобок содержится весь код, запускающийся всякий раз, когда вызываем функцию.

      //Первая строка (строка под номером 2 в коде выше) объявляет переменную с именем userGuess и устанавливает её значение на то, что сейчас введено в текстовое поле. Мы также пропускаем это значение через встроенный метод Number(), чтобы убедится, что значение точно является числом.
      function checkGuess() {
        const userGuess = Number(guessField.value)
        //Затем мы сталкиваемся с нашим первым блоком условного кода (строки 3–5 в коде выше). Блок условного кода позволяет выборочно запускать код в зависимости от того, является определённое условие истинным или нет. Он немного похож на функцию, но это не так. Простейшая форма условного блока начинается с ключевого слова if, за ним круглые скобки, за ними ещё фигурные скобки. В круглые скобки мы добавляем проверку. Если проверка возвращает true, запускается код в фигурных скобках. Если нет, этот код пропускается и мы переходим к следующей части кода. В этом случае проверяется, равна ли переменная guessCount числу 1 (то есть является ли это первой попыткой игрока или нет):
        //Если это так, мы выводим параграф с содержанием "Previous guesses: ". Если нет, ничего не делаем.
        if (guessCount === 1) {
          guesses.textContent = 'Previous guesses: '
        }
        //Строка 6 добавляет текущее значение userGuess в конец параграфа guesses, плюс пустое пространство, поэтому между каждыми показанными предположениями будет пробел.
        guesses.textContent += userGuess + ' '

        //Следующий блок (строки 8–24 ) делает несколько проверок:
        // Первая конструкция if(){ } проверяет, совпадает ли предположение пользователя с randomNumber, установленному в верхней части нашего JavaScript. Если это так, игрок правильно догадался, и игра выиграна, поэтому мы показываем игроку поздравительное сообщение с приятным зелёным цветом, очищаем содержимое окна информации о минимуме / максимуме и запускаем функцию, называемую setGameOver (), которую мы обсудим позже.
        // Теперь мы добавили ещё одну проверку после предыдущей, используя конструкцию else if () {}. Эта конструкция проверяет, является ли этот ход последним ходом пользователя. Если это так, программа выполняет то же самое, что и в предыдущем блоке, но выведет сообщение с текстом GAME OVER.
        // Последний блок, в конце нашего кода (else {}), содержит код, который запускается только в том случае, если ни один из двух других тестов не возвращает true (т. е. игрок не догадался правильно, но у него ещё остались догадки). В этом случае мы говорим игроку, что он ошибся, затем мы выполняем ещё один условный тест, чтобы проверить, было ли предположение больше или меньше ответа, показывая дополнительное сообщение.
        if (userGuess === randomNumber) {
          lastResult.textContent = 'Поздравляю! Вы угадали число!'
          lastResult.style.backgroundColor = 'green'
          lowOrHi.textContent = ''
          setGameOver()
        } else if (guessCount === 10) {
          lastResult.textContent = '!!!КОНЕЦ ИГРЫ!!!'
          lowOrHi.textContent = ''
          setGameOver()
        } else {
          lastResult.textContent = 'Не верно!'
          lastResult.style.backgroundColor = 'red'
          if (userGuess < randomNumber) {
            lowOrHi.textContent = 'Последнее предположение было слишком низким!'
          } else if (userGuess > randomNumber) {
            lowOrHi.textContent =
              'Последнее предположение было слишком высоким!'
          }
        }

        //Последние три строки в функции (строки 26–28 ) готовят нас к следующей попытке. Мы добавляем 1 к переменной guessCount, так как игрок использовал свой ход (++ оператор инкремента — увеличивает на 1), очищаем значение текстового поля и фокусируемся на нем снова, готовы для ввода следующего ответа.
        guessCount++
        guessField.value = ''
        guessField.focus()
      }
      //Здесь мы добавляем обработчик событий к кнопке guessSubmit. Это метод, который принимает два входных значения (называемые аргументами) - тип события, которое мы обработаем (в данном случае click) в виде строки, и код, который мы хотим запустить при возникновении события (в данном случае функция checkGuess(), обратите внимание, что нам не нужно указывать круглые скобки при записи внутри addEventListener()).
      guessSubmit.addEventListener('click', checkGuess)

      function setGameOver() {
        //Первые две строки отключают ввод текста и кнопку формы, устанавливая их отключённые свойства как true. Это необходимо, потому что, если бы мы этого не сделали, пользователь мог бы представить больше догадок после завершения игры, что испортит ситуацию.
        guessField.disabled = true
        guessSubmit.disabled = true
        //Следующие три строки генерируют новый элемент <button>, устанавливают его текстовую метку « Start new game» и добавляют её к нижней части нашего HTML.
        resetButton = document.createElement('button')
        resetButton.textContent = 'Начать игру'
        document.body.append(resetButton)
        //Последняя строка устанавливает обработчик событий на нашей новой кнопке, так что при нажатии на неё запускается функция resetGame().
        resetButton.addEventListener('click', resetGame)
      }
      function resetGame() {
        //Устанавливает значение guessCount на 1.
        //Удаляет все пункты информации.
        //Удаляет кнопку сброса из нашего кода.
        //Включает элементы формы, устанавливает фокус, делает поле доступным для следующих угадываний.
        //Удаляет цвет фона из абзаца lastResult.
        //Создаёт новое случайное число, чтобы Вы не угадывали одно и тоже!
        guessCount = 1

        const resetParas = document.querySelectorAll('.resultParas p')
        for (const resetPara of resetParas) {
          resetPara.textContent = ''
        }

        resetButton.parentNode.removeChild(resetButton)

        guessField.disabled = false
        guessSubmit.disabled = false
        guessField.value = ''
        guessField.focus()

        lastResult.style.backgroundColor = 'white'

        randomNumber = Math.floor(Math.random() * 100) + 1
      }
    </script>
  </body>
</html>
